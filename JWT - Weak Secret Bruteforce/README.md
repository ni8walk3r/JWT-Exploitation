# Vulnerability: 

The integrity of the token relies on the strength of the secret used to sign the token. If an attacker can find the secret, he will be able to forge her own malicious token. 

# Usage:

First we have to bruteforce the "secret" key used to compute the signature:

1) We have to convert the JWT token in the format that [John the Ripper](https://www.openwall.com/john/) can understand, for that we will be using [jwtcrack tool](https://github.com/Sjord/jwtcrack):
`python jwt2john.py [JWT Token] > jwt.txt`
![JWT Weak Secret Bruteforce](https://github.com/ni8walk3r/JWT-Exploitation/blob/master/JWT%20-%20Weak%20Secret%20Bruteforce/images/1.png)

![JWT Weak Secret Bruteforce](https://github.com/ni8walk3r/JWT-Exploitation/blob/master/JWT%20-%20Weak%20Secret%20Bruteforce/images/2.png)

2) Run [John the Ripper](https://www.openwall.com/john/) by using the following command:
`john jwt.txt --wordlist=rockyou.txt`
![JWT Weak Secret Bruteforce](https://github.com/ni8walk3r/JWT-Exploitation/blob/master/JWT%20-%20Weak%20Secret%20Bruteforce/images/3.png)

Now after getting the secret, we have to edit the Payload section of JWT and sign it using the secret we found in previous step for generating the forged token:

The script can be used in the following manner:

1) Download the jwt.rb file
2) Run it by giving following command: ruby jwt.rb
3) Enter the JWT token and value of the claim you want to make changes in
4) A new modified JWT token will be created, use it for further exploitation

![JWT Weak Secret Bruteforce](https://github.com/ni8walk3r/JWT-Exploitation/blob/master/JWT%20-%20Weak%20Secret%20Bruteforce/images/4.png)
