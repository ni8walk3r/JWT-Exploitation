# Vulnerability:
The algorithm HS256 uses the secret key to sign and verify each message and the algorithm RS256 uses the private key to sign the message and uses the public key for authentication.

Since the public key can sometimes be obtained by the attacker, an attacker can modify the algorithm in the header to HS256 and then use the RSA public key to sign the data.

The application will verify the signature with the public key but since you are forcing the application to use HMAC, it will actually verify the signature with HMAC(public_key, data). As an attacker, you have everything you need to generate a valid signature.

# Usuage:
The script can be used in the following manner:
1) Download the jwt.rb file
2) Download the public key of the target web application and keep it in the same folder as jwt.rb
3) Run it by giving following command - ruby jwt.rb
4) Enter the JWT token and value of the claim you want to make changes in
5) A new modified JWT token will be created, use it for further exploitation

![JWT RS256 to HS256 Algorithm](https://github.com/ni8walk3r/JWT-Exploitation/blob/master/JWT%20Signature%20-%20RS256%20to%20HS256/images/jwt.jpg)

![JWT RS256 to HS256 Algorithm](https://github.com/ni8walk3r/JWT-Exploitation/blob/master/JWT%20Signature%20-%20RS256%20to%20HS256/images/jwt1.jpg)

For Finding Public Key which Server is using:

1) Directly from host/public.key
2) Server’s TLS certificate, which may be being re-used for JWT operations:
openssl s_client -connect <hostname>:443
Copy the “Server certificate” output to a file (e.g. cert.pem) and extract the public key (to a file called key.pem) by running:
openssl x509 -in cert.pem -pubkey –noout > public.pem
