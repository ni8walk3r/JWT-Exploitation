# Vulnerability:
Since the public key can sometimes be obtained by the attacker, the attacker can modify the algorithm in the header to HS256 and then use the RSA public key to sign the data.

# Usuage:
The script can be used in the following manner:
1) Download the jwt.rb file
2) Run it by giving following command - ruby jwt.rb
3) Enter the JWT token and value of the claim you want to make changes in
4) A new modified JWT token will be created, use it for further exploitation

![JWT RS256 to HS256 Algorithm](https://github.com/ni8walk3r/JWT-Exploitation/blob/master/JWT%20Signature%20-%20RS256%20to%20HS256/images/jwt.jpg)

![JWT RS256 to HS256 Algorithm](https://github.com/ni8walk3r/JWT-Exploitation/blob/master/JWT%20Signature%20-%20RS256%20to%20HS256/images/jwt1.jpg)

With RSA, to:

    sign a token, you need the private key.
    verify a token, you can use the public key corresponding to the private key used for the signature.

With HMAC, to:
* sign a token, you need the secret.
* verify a token, you need the same secret.

In practice, you can change the algorithm used by the application (RSA - RS256) to tell it to use HMAC (HS256). The application will call the method verify when you send the cookie. Since the code is written to use RSA, it will call verify(public_key, data). But since the algorithm is set to HMAC, it will end up calling HMAC(public_key,data).

The application will verify the signature with the public key but since you are forcing the application to use HMAC, it will actually verify the signature with HMAC(public_key, data). As an attacker, you have everything you need to generate a valid signature, since the public key is actually public. 


